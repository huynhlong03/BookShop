@*@model IEnumerable<BookShop_WebApplication.Models.BOOK>*@
@using PagedList.Mvc;
@using PagedList;
@model IPagedList<BookShop_WebApplication.Models.BOOK>
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayoutPage.cshtml";
    ViewBag.Active = 3;
}

<section class="wrapper">
    <div class="row" style="height: 600px">
        <div class="col-lg-12 main-chart">
            <div style="">
                <div class="form-inline">
                    @using (@Html.BeginForm("SearchBook", "BookManagement", FormMethod.Post))
                    {
                        <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search" name="searchInput">
                        <button class="btn btn-primary my-2 my-sm-0" type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
                    }
                </div>

            </div>
            <p style="float:right"><a class="btn btn-success float-left" href="~/Admin/BookManagement/AddBook"><i class="fa-solid fa-plus"></i> Add book</a></p>
            <div id="books">
                @if (Model != null && Model.Any())
                {
                    <table class="table">
                        <tr>
                            <th>
                                STT
                            </th>
                            <th>
                                Name
                            </th>
                            <th>
                                Price
                            </th>

                            <th>
                                Update Date
                            </th>
                            <th>
                                Image
                            </th>
                            <th>
                                Quanlity
                            </th>

                            <th></th>
                        </tr>

                        @for (int i = 0; i < Model.Count; i++)
                        {
                            var item = Model[i];

                            <tr>
                                <td>@(i + 1)</td>
                                <td>
                                    <p style="color:blueviolet"> @Html.DisplayFor(modelItem => item.BookName)</p>
                                </td>
                                <td>
                                    <p style="color:red"> @string.Format("{0:#,0}", item.Price)</p>
                                </td>

                                <td>
                                    @string.Format("{0:dd-MM-yyyy}", item.UpdateDate)
                                </td>
                                <td>
                                    <img src="~/assets/product-img/@Html.DisplayFor(modelItem => item.Image)" width="80px" />
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Quanlity)
                                </td>

                                <td>
                                    <a class="btn btn-info" href="~/Admin/BookManagement/DetailBook?bookId=@item.BookID">View</a>
                                    <a class="btn btn-primary" href="~/Admin/BookManagement/EditBook?bookId=@item.BookID">Edit</a>
                                    <a class="btn btn-danger" href="~/Admin/BookManagement/DeleteBook?bookId=@item.BookID">Delete</a>
                                </td>
                            </tr>
                        }
                    </table>
                }
            </div>
            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-danger">
                    @TempData["ErrorMessage"]
                </div>
            }
            <div class="pagination">
                @Html.PagedListPager(Model, page => Url.Action("Index", new { page = page, pagesize = @ViewBag.PageSize }))
            </div>
        </div>
    </div>
</section>

<script>
    function loadBooks(page, pagesize) {
        $.ajax({
            url: "/Admin/BookManagement/Index",
            data: {
                page: page,
                pagesize: pagesize
            },
            success: function (data) {
                $("#books").html(data);
            }
        });
    }
</script>